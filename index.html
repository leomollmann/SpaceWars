<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body style="padding: 0; margin: 0">
    <script src="three.js" type="text/javascript"></script>
    <script src="OrbitControls.js" type="text/javascript"></script>
    <script src="CopyShader.js" type="text/javascript"></script>
    <script src="EffectComposer.js" type="text/javascript"></script>
    <script src="RenderPass.js" type="text/javascript"></script>
    <script src="ShaderPass.js" type="text/javascript"></script>
    <script src="FXAAShader.js" type="text/javascript"></script>
    <script src="Ship.js" type="text/javascript"></script>
    <canvas id="threejs" style="margin: 0, padding: 0"></canvas>
    <script>
      const renderer = new THREE.WebGLRenderer({canvas: document.getElementById("threejs")});

      renderer.setClearColor(0x000000);
      renderer.setSize( window.innerWidth, window.innerHeight );

      const scene = new THREE.Scene();
      var sectors = new Map();
      var ships = [];
      //scene.fog = new THREE.FogExp2( 0x000000, 0.008 );

      const camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 1000 );
      const controls = new THREE.OrbitControls(camera);
      const composer = new THREE.EffectComposer(renderer);

      scene.add(new THREE.AmbientLight(0xffffff, 0.1));
      scene.add(new THREE.DirectionalLight(0xffffff, 0.8));
      scene.add(camera);
      camera.position.set( 0, 0, 40 );

      const material = new THREE.MeshLambertMaterial();
      for(let i = 0; i < 200; i++){
        ships.push(new Ship(1));
      }

      var pass = [];
      pass.push(new THREE.RenderPass(scene, camera));
      //pass.push(new THREE.ShaderPass(THREE.CopyShader));
      //pass.push(new THREE.ShaderPass(THREE.FXAAShader));

      pass.forEach((item) => {composer.addPass(item)});
      pass[pass.length - 1].renderToScreen = true;

      function animate(){
        ships.forEach((item) => {item.updateSector()});
        ships.forEach((item) => {item.computeForces()});
        ships.forEach((item) => {item.applyForces()});
        sectors.clear();
        controls.update();
        composer.render();
        requestAnimationFrame(animate);
      }
      animate();
    </script>
  </body>
</html>
